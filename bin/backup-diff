#!/bin/bash
set -euo pipefail
cd ~/.backup
if [ -z "${commit:-}" ]; then
    git diff -U0 --cached | grep '\+\./' | sed 's/^\+//' | sed -r 's/\tref::[^\t]+/\tref::/'
else
    git show -U0 "$commit" | grep '\+\./' | sed 's/^\+//' | sed -r 's/\tref::[^\t]+/\tref::/'
fi
